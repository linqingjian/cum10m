# AI Browser Assistant 测试指南

## 📋 安装与配置

### 1. 在 Chrome 中加载扩展
1. 打开 Chrome 浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角的「开发者模式」
4. 点击「加载已解压的扩展程序」
5. 选择 `/Users/lqj/cum10m/chrome-extension` 目录
6. 扩展加载成功后，会自动打开设置页面

### 2. 配置 API Token

在设置页面（options.html）中填写以下信息：

**必填项：**
- **API URL**: `https://model-router.meitu.com/v1/chat/completions`
- **API Token**: 填入你的 API Token
- **模型名称**: `gpt-4o`

**可选项：**
- **Webhook URL**: 企业微信 webhook（用于接收通知）

点击「保存配置」后，点击「测试连接」确认配置正确。

## 🧪 功能测试

### 基础功能测试

#### 1. 文件结构检查
```bash
cd /Users/lqj/cum10m/chrome-extension
./run-tests.sh check
```

#### 2. 测试页面交互
1. 在 Chrome 中打开测试页面：
   - 直接打开 file:///Users/lqj/cum10m/chrome-extension/test.html
   - 或在本地服务器上运行

2. 确保扩展图标在工具栏中显示
3. 点击扩展图标打开侧边栏

### 核心功能测试

#### 测试 1：页面导航
**命令：** "导航到 Google"

**预期结果：**
- 浏览器跳转到 https://www.google.com
- 侧边栏显示「导航到 Google」
- 状态显示「任务完成」

#### 测试 2：填写表单
**前提：** 在测试页面上

**命令：** "在测试输入框中填入 'Hello AI'"

**预期结果：**
- 测试输入框被填入「Hello AI」
- 日志显示操作步骤

#### 测试 3：获取表格数据
**前提：** 在测试页面上

**命令：** "获取表格内容"

**预期结果：**
- 侧边栏显示表格的 JSON 数据
- 包含姓名、年龄、城市、职业等信息

#### 测试 4：文本提取
**前提：** 在测试页面上

**命令：** "提取页面的标题"

**预期结果：**
- 返回页面标题文本
- 日志显示提取过程

#### 测试 5：点击按钮
**前提：** 在测试页面上

**命令：** "点击测试按钮"

**预期结果：**
- 触发按钮点击事件
- 弹出提示框（按钮本身的 alert）

#### 测试 6：页面滚动
**前提：** 在测试页面上

**命令：** "滚动到页面底部"

**预期结果：**
- 页面滚动到底部
- 日志显示滚动操作

### 多轮对话测试

#### 场景 1：复合任务
**命令序列：**
1. "导航到 test.html" （或者 "刷新当前页面"）
2. "在搜索框输入 '测试'"
3. "点击搜索按钮"
4. "提取搜索结果"

**预期结果：**
- 每步独立执行
- 有清晰的日志输出
- 最后返回搜索结果

#### 场景 2：错误恢复
**命令：** "点击一个不存在的按钮 ID"（例如："点击 #nonexistent-button"）

**预期结果：**
- 识别到错误
- AI 尝试智能恢复或给出明确错误信息
- 不导致扩展崩溃

#### 场景 3：长时间任务
**命令：** "帮我遍历页面上的所有链接"（可能需要多次步骤）

**预期结果：**
- 逐步执行
- 达到最大步骤数（默认 15）时安全停止
- 返回已收集的信息

## 🎯 高级测试

### 技能扩展测试

Skills 配置文件位置：`skills/config.js`

测试自定义技能：
1. 编辑 `skills/config.js` 添加新技能
2. 重新加载扩展（chrome://extensions/ 中的刷新按钮）
3. 测试新技能是否生效

### 平台适配测试

测试在不同网站上的适配：
1. 打开任意网站（如 GitHub、百度、淘宝等）
2. 使用助手与页面交互
3. 验证选择器是否正确

**示例命令：**
- GitHub: "获取这个仓库的星标数"
- 百度: "搜索 'AI Assistant'"
- 淘宝: "搜索 '手机'"

## 📊 性能测试

### 1. 内存占用
1. 打开 `chrome://extensions/`
2. 找到「AI Browser Assistant」
3. 点击「查看视图：background page」
4. 在 DevTools > Performance 中监控内存

### 2. 响应速度
- 记录从发送任务到首次 AI 响应的时间
- 记录每个操作的平均执行时间

### 3. 长时间稳定性
- 连续执行 10+ 个任务
- 监控是否有内存泄漏
- 检查日志是否正确轮转（最多 1000 条）

## 🐛 调试技巧

### 查看 Console 日志

**Background 日志：**
1. `chrome://extensions/`
2. 点击「查看视图：background page」
3. 查看 Console

**Content Script 日志：**
1. 在目标页面右键 > 检查
2. 查看 Console

### 使用测试页面

测试页面（test.html）包含各种交互元素：
- 输入框
- 按钮
- 下拉框
- 表单
- 表格
- 文本内容

可以反复测试各种操作。

### 重置配置

如果需要重置配置：
1. 打开设置页面（chrome-extension://.../options.html）
2. 点击「重置为默认」
3. 保存配置

## ✅ 验证清单

安装后必须验证的功能：

- [ ] 扩展成功加载到 Chrome
- [ ] 设置页面正常打开
- [ ] API Token 配置和测试连接成功
- [ ] 侧边栏正常显示
- [ ] 测试页面可以正常交互
- [ ] 导航功能正常
- [ ] 表单填写功能正常
- [ ] 表格提取功能正常
- [ ] 多轮对话正常
- [ ] 日志正常显示
- [ ] 停止任务功能正常

## 🚀 部署前检查

在正式使用前，确保：
1. 所有测试用例通过
2. API Token 安全存储（不在代码中硬编码）
3. 错误处理健壮
4. 日志不泄露敏感信息
5. 达到最大步骤数时安全退出

## 📝 反馈与问题

如果遇到问题，请记录：
1. 操作步骤
2. 预期结果 vs 实际结果
3. Console 中的错误信息
4. Background 日志
5. Content Script 日志

将这些信息用于调试和优化。
